{% set parent_template = app.user and is_granted('ROLE_ADMIN') ? 'admin/base.html.twig' : 'base.html.twig' %}

{% extends parent_template %}

{% block title %}Profile Update
{% endblock %}

{% block javascripts %}
	{{ parent() }}
	<script src="https://www.google.com/recaptcha/api.js" async defer></script>
{% endblock %}

{% block body %}
	<div class="container shadow-sm p-5 mt-5 mb-5 bg-white rounded">
		<h1 class="my-4 text-center">Update Your Profile</h1>

		{{ form_start(form, {'attr': {'data-turbo': 'false', 'novalidate': 'novalidate'}}) }}

		{% for field in [form.name, form.surname, form.email, form.phone, form.addresse] %}
			<div class="mb-3">
				{{ form_label(field) }}
				{{ form_widget(field, {'attr': {'class': 'form-control'}}) }}
				{% if field.vars.errors|length > 0 %}
					<div class="text-danger small">{{ form_errors(field) }}</div>
				{% endif %}
			</div>
		{% endfor %}

		<div class="mb-3">
			{{ form_label(form.profilePhoto) }}
			{{ form_widget(form.profilePhoto, {'attr': {'class': 'form-control'}}) }}
			<div class="form-text">You can update your profile photo.</div>
			{% if app.user.profilePhoto %}
				<img src="{{ asset(app.user.profilePhoto) }}" alt="Profile Photo" class="img-thumbnail mt-2" style="max-width: 150px;">
			{% else %}
				<img src="https://via.placeholder.com/150" alt="Default Profile Photo" class="img-thumbnail mt-2" style="max-width: 150px;">
			{% endif %}
			{% if form.profilePhoto.vars.errors|length > 0 %}
				<div class="text-danger small">
					{{ form_errors(form.profilePhoto) }}
				</div>
			{% endif %}
		</div>

		<div class="d-flex justify-content-between">
			<a href="{{ app.user and is_granted('ROLE_ADMIN') ? path('admin_dashboard') : path('app_home') }}" class="btn btn-secondary">Cancel</a>
			{{ form_widget(form.submit, {'attr': {'class': 'btn btn-primary'}}) }}
		</div>

		{{ form_end(form) }}
	</div>
{% endblock %}
